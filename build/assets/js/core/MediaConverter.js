import{MediaBunny}from"./MediaBunny.js";export class MediaConverter{static async convert({source:e,format:t,quality:n,onProgress:a}){const r=new MediaBunny.BlobSource(e),o=new MediaBunny.Input({source:r,formats:MediaBunny.ALL_FORMATS});let u;switch(t){case"mp4":u=new MediaBunny.Mp4OutputFormat;break;case"webm":u=new MediaBunny.WebMOutputFormat;break;case"mov":u=new MediaBunny.QuickTimeOutputFormat;break;default:throw new Error(`Unsupported format: ${t}`)}const i=new MediaBunny.Output({format:u,target:new MediaBunny.BufferTarget});let s={};if(n<100){let e;e=n>=80?25e5:n>=60?15e5:8e5,s={bitrate:e,forceTranscode:!0}}const c=await MediaBunny.Conversion.init({input:o,output:i,video:s});return a&&(c.onProgress=a),await c.execute(),new Blob([i.target.buffer],{type:`video/${t}`})}}